!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{AL2A:function(n,r,s){"use strict";s.r(r),s.d(r,"SettingModule",(function(){return x}));var o=s("2kYt"),i=s("EM62"),a=s("DSWM"),c=s("nIj0"),l=s("sEIs"),p=s("sN6X"),d=s("s2Ay"),u=s("x8Mb"),h=s("PIN6"),m=s("cHUu"),f=s("mOXJ"),v=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))},b=function(e){return e&&e.__esModule?e:{default:e}},g=function(){function n(t,r,s,o,i,a,c){e(this,n),this.store=t,this.utilService=r,this.masterService=s,this.actionService=o,this.formBuilder=i,this.translate=a,this.router=c,this.viewType=u.b.Common.ViewType,this.printers=u.b.Common.Printer.printers,this.connectionType=u.b.Common.Printer.ConnectionType,this.environment=Object(h.a)()}var r,s,o;return r=n,(s=[{key:"ngOnInit",value:function(){return v(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=this.store.pipe(Object(p.m)(f.b)),this.user=this.store.pipe(Object(p.m)(f.g)),this.error=this.store.pipe(Object(p.m)(f.a)),this.theaters=[],e.prev=1,e.next=4,this.masterService.searchMovieTheaters();case 4:return this.theaters=e.sent,e.next=7,this.createBaseForm();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),this.router.navigate(["/error"]);case 12:case"end":return e.stop()}}),e,this,[[1,9]])})))}},{key:"createBaseForm",value:function(){return v(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.baseForm=this.formBuilder.group({theaterBranchCode:["",[c.k.required]],posId:["",[c.k.required]],printerType:["",[c.k.required]],printerIpAddress:[""]}),e.next=3,this.actionService.user.getData();case 3:void 0!==(t=e.sent).theater&&(this.baseForm.controls.theaterBranchCode.setValue(t.theater.branchCode),this.changePosList()),void 0!==t.pos&&this.baseForm.controls.posId.setValue(t.pos.id),void 0!==t.printer&&(this.baseForm.controls.printerType.setValue(t.printer.connectionType),this.baseForm.controls.printerIpAddress.setValue(t.printer.ipAddress));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"changePosList",value:function(){this.baseForm.controls.posId.setValue("");var e=this.baseForm.controls.theaterBranchCode.value;if(""!==e){var t=this.theaters.find((function(t){return t.branchCode===e}));this.posList=void 0!==t?void 0===t.hasPOS?[]:t.hasPOS:[]}else this.posList=[]}},{key:"updateBase",value:function(){return v(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,s,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(this.baseForm.controls).forEach((function(e){o.baseForm.controls[e].markAsTouched()})),!this.baseForm.invalid){e.next=4;break}this.utilService.openAlert({title:this.translate.instant("common.error"),body:this.translate.instant("setting.alert.validation")}),e.next=17;break;case 4:if(e.prev=4,t=this.baseForm.controls.theaterBranchCode.value,n=this.baseForm.controls.posId.value,void 0!==(r=this.theaters.find((function(e){return e.branchCode===t})))&&void 0!==r.hasPOS){e.next=8;break}throw new Error("theater not found");case 8:if(void 0!==(s=r.hasPOS.find((function(e){return e.id===n})))){e.next=11;break}throw new Error("pos not found");case 11:this.actionService.user.updateBaseSetting({pos:s,theater:r,printer:{ipAddress:this.baseForm.controls.printerIpAddress.value,connectionType:this.baseForm.controls.printerType.value}}),this.utilService.openAlert({title:this.translate.instant("common.complete"),body:this.translate.instant("setting.alert.success")}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),console.error(e.t0);case 17:case"end":return e.stop()}}),e,this,[[4,14]])})))}},{key:"print",value:function(){return v(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={connectionType:this.baseForm.controls.printerType.value,ipAddress:this.baseForm.controls.printerIpAddress.value},e.next=4,this.actionService.order.print({orders:[],printer:t});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0),this.utilService.openAlert({title:this.translate.instant("common.error"),body:'\n                <p class="mb-4">'.concat(this.translate.instant("setting.alert.print"),'</p>\n                <div class="p-3 bg-light-gray select-text error">\n                    <code>').concat(e.t0,"</code>\n                </div>")});case 9:case"end":return e.stop()}}),e,this,[[0,6]])})))}},{key:"changePrinterType",value:function(){this.baseForm.controls.printerType.value===u.b.Common.Printer.ConnectionType.StarBluetooth&&this.baseForm.controls.printerIpAddress.setValue(this.translate.instant("setting.starBluetoothAddress"))}}])&&t(r.prototype,s),o&&t(r,o),n}();g.ctorParameters=function(){return[{type:p.b},{type:m.f},{type:m.c},{type:m.a},{type:c.b},{type:d.c},{type:l.c}]},g=function(e,t,n,r){var s,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,n,i):s(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}([Object(i.n)({selector:"app-setting",template:b(s("XREv")).default,styles:[b(s("zopa")).default]}),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[p.b,m.f,m.c,m.a,c.b,d.c,l.c])],g);var y=[{path:"",component:s("RRjC").a,children:[{path:"",component:g}]}],w=function t(){e(this,t)};w=function(e,t,n,r){var s,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,n,i):s(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}([Object(i.K)({imports:[l.d.forChild(y)],exports:[l.d]})],w);var x=function t(){e(this,t)};x=function(e,t,n,r){var s,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,n,i):s(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}([Object(i.K)({declarations:[g],imports:[o.c,w,a.a]})],x)},XREv:function(e,t,n){"use strict";n.r(t),t.default='<div class="contents-width mx-auto px-3 py-5">\n    <h2 class="text-large mb-4 text-center font-weight-bold">{{ \'setting.title\' | translate }}</h2>\n    <p class="mb-4 text-md-center" [innerHTML]="\'setting.read\' | translate"></p>\n    <form *ngIf="baseForm" [formGroup]="baseForm">\n        <div class="mb-4 p-3 bg-white">\n\n            <div class="form-group">\n                <div class="row align-items-center">\n                    <p class="col-md-4 py-2 text-md-right">{{ \'common.theater\' | translate }}<span\n                        class="badge badge-danger ml-2">{{ \'form.required\' | translate }}</span></p>\n                    <div class="col-md-8">\n                        <select class="form-control" formControlName="theaterBranchCode" (change)="changePosList()">\n                            <option value="">{{ \'setting.unselected\' | translate }}</option>\n                            <option *ngFor="let theater of theaters"\n                                [value]="theater.branchCode">{{ theater.name | changeLanguage }}</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n\n            <div class="form-group">\n                <div class="row align-items-center">\n                    <p class="col-md-4 py-2 text-md-right">{{ \'setting.pos\' | translate }}<span\n                        class="badge badge-danger ml-2">{{ \'form.required\' | translate }}</span></p>\n                    <div class="col-md-8">\n                        <select class="form-control" formControlName="posId">\n                            <option value="">{{ \'setting.unselected\' | translate }}</option>\n                            <option *ngFor="let pos of posList" [value]="pos.id">{{ pos.name }}</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n            \n            <div class="form-group">\n                <div class="row align-items-center">\n                    <p class="col-md-4 py-2 text-md-right">{{ \'setting.printer\' | translate }}</p>\n                    <div class="col-md-8">\n                        <select class="form-control" formControlName="printerType">\n                            <option value="">{{ \'setting.unselected\' | translate }}</option>\n                            <option *ngFor="let printer of printers" [value]="printer.connectionType">\n                                {{ printer.name | translate }}</option>\n                        </select>\n                        <button\n                            *ngIf="this.baseForm.controls.printerType.value && this.baseForm.controls.printerType.value !== connectionType.None"\n                            type="button" class="btn btn-sm btn-primary py-2 mt-2"\n                            (click)="print()">{{ \'setting.testPrinting\' | translate }}</button>\n                    </div>\n                </div>\n            </div>\n            <div class="form-group">\n                <div class="row align-items-center">\n                    <p class="col-md-4 py-2 text-md-right">{{ \'setting.printerIpAddress\' | translate }}</p>\n                    <div class="col-md-8">\n                        <input type="text" class="form-control" formControlName="printerIpAddress"\n                            placeholder="0.0.0.0">\n                        <div *ngIf="baseForm.controls.printerIpAddress.invalid && baseForm.controls.printerIpAddress.touched"\n                            class="mt-2">\n                            <p *ngIf="baseForm.controls.printerIpAddress.errors?.required" class="text-danger">\n                                {{ \'form.validation.required\' | translate }}</p>\n                        </div>\n                        <p class="text-small mt-2">\n                            {{ \'setting.printerIpAddressDescription\' | translate }}\n                        </p>\n                    </div>\n                </div>\n            </div>\n            \n\n        </div>\n        <div class="buttons mx-auto text-center">\n            <button type="submit" class="btn btn-primary btn-block py-3 mb-3" [disabled]="isLoading | async"\n                (click)="updateBase()">{{ \'setting.next\' | translate }}</button>\n            <button type="button" class="btn btn-outline-primary btn-block py-3"\n                [routerLink]="environment.BASE_URL">{{ \'setting.prev\' | translate }}</button>\n        </div>\n    </form>\n</div>'},zopa:function(e,t,n){"use strict";n.r(t),t.default=""}}])}();